{% extends 'sitemngr/base.html' %}

{% block content %}

<center>

{% if info %}
    {{ info }}<br><br><br>
{% endif %}

<h3>Downtime ID Change - {{ system }}</h3><br>

<div class="row">
    <div class="span6">
        <h5>Database Current</h5>
        {% if sites %}
            {% for s in sites %}
                {{ s.scanid }}: {{ s.name }} <b>{% if s.isAnom %}Anomaly{% else %}Signature{% endif %}</b><br>
            {% endfor %}
        {% endif %}
        {% if wormholes %}
            {% for w in wormholes %}
                {{ w.scanid }}: {{ w.start }} > {{ w.destination }} <b>Wormhole</b><br>
            {% endfor %}
        {% endif %}
    </div>
    <div class="span6">
        <h5>New from Paste</h5>
        {% if newids %}
            {% for n in newids %}
                {{ n.scanid }} <b>{{ n.type }}</b> {{ n.name }}<br>
            {% endfor %}
        {% else %}
            <p>None</p>
        {% endif %}
    </div>
</div>

<hr style="width: 50%;">

<form action="" method="POST">
    {% csrf_token %}
    <input type="hidden" name="afterdowntime" value="1">
    <table>
        <tr>
            <th>
                Old ID
            </th>
            <th>
                Type
            </th>
            <th>
                New ID
            </th>
        </tr>
        {% if sites %}
            {% for s in sites %}
                <tr>
                    <td>
                        <input type="text" value="{{ s.scanid }} {{ s.name }}" readonly>
                    </td>
                    <td>
                        {% if s.isAnom %}Anom{% else %}Sig{% endif %}
                    </td>
                    <td>
                       <select name="{{ s.scanid }}">
                            <option>-IGNORE-</option>
                            {% for n in newids %}
                                 <option>{{ n }}</option>
                            {% endfor %}
                            <option>-CLOSE-</option>
                        </select>
                    </td>
                </tr>
            {% endfor %}
        {% endif %}
        {% if wormholes %}
            {% for w in wormholes %}
                <tr>
                    <td>
                        <input type="text" value="{{ w.scanid }}, {{ w.start }} > {{ w.destination }}" readonly>
                    </td>
                    <td>
                        Worm
                    </td>
                    <td>
                        <select name="{{ w.scanid }}">
                            <option>-IGNORE-</option>
                            {% for n in newids %}
                                 <option>{{ n }}</option>
                            {% endfor %}
                            <option>-CLOSE-</option>
                        </select>
                    </td>
                </tr>
            {% endfor %}
        {% endif %}
        <tr>
            <td></td>
            <td>
                <input type="submit" value="Store">
            </td>
            <td></td>
        </tr>
    </table>
</form>

</center>

{% endblock %}
